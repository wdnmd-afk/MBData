# Metabase é¡¹ç›®æ·±åº¦åˆ†æ - ç¬¬å››éƒ¨åˆ†: æµ‹è¯•ä½“ç³»ä¸éƒ¨ç½²

> ç”Ÿæˆæ—¶é—´: 2025-11-19

---

## ğŸ§ª æµ‹è¯•ä½“ç³»

### å‰ç«¯æµ‹è¯•

#### å•å…ƒæµ‹è¯• (Jest)
```bash
yarn test-unit                    # è¿è¡Œæ‰€æœ‰æµ‹è¯•
yarn test-unit-watch              # ç›‘å¬æ¨¡å¼
yarn test-unit-keep-cljs file.ts  # ç‰¹å®šæ–‡ä»¶
```

#### E2E æµ‹è¯• (Cypress)
```bash
yarn test-cypress                 # è¿è¡Œæ‰€æœ‰ E2E æµ‹è¯•
yarn cypress open                 # äº¤äº’æ¨¡å¼
```

#### è§†è§‰å›å½’æµ‹è¯• (Loki)
```bash
yarn test-visual:loki             # è§†è§‰æµ‹è¯•
yarn test-visual:loki-approve-diff # æ‰¹å‡†å·®å¼‚
```

### åç«¯æµ‹è¯•

#### Clojure æµ‹è¯•
```bash
clojure -X:dev:test               # æ‰€æœ‰æµ‹è¯•
./bin/mage run-tests namespace    # ç‰¹å®šå‘½åç©ºé—´
```

#### æµ‹è¯•æ ‡è®°
- `^:parallel` - å¹¶è¡Œè¿è¡Œçš„çº¯å‡½æ•°æµ‹è¯•
- `^:integration` - é›†æˆæµ‹è¯•
- `^:drivers/all` - æ‰€æœ‰é©±åŠ¨æµ‹è¯•

---

## ğŸš€ æ„å»ºä¸éƒ¨ç½²

### æœ¬åœ°æ„å»º

#### å‰ç«¯æ„å»º
```bash
yarn build                        # å¼€å‘æ„å»º
yarn build-release                # ç”Ÿäº§æ„å»º
yarn build-embedding-sdk-package  # SDK æ„å»º
```

#### åç«¯æ„å»º
```bash
./bin/mage build                  # å®Œæ•´æ„å»º
```

### Docker éƒ¨ç½²

```bash
# æ„å»ºé•œåƒ
docker build -t metabase:latest .

# è¿è¡Œå®¹å™¨
docker run -d -p 3000:3000 \
  -e MB_DB_TYPE=postgres \
  -e MB_DB_HOST=postgres \
  metabase:latest
```

### ç¯å¢ƒå˜é‡

**æ•°æ®åº“é…ç½®**:
- `MB_DB_TYPE`: postgres/mysql/h2
- `MB_DB_HOST`: æ•°æ®åº“ä¸»æœº
- `MB_DB_PORT`: æ•°æ®åº“ç«¯å£
- `MB_DB_USER`: æ•°æ®åº“ç”¨æˆ·
- `MB_DB_PASS`: æ•°æ®åº“å¯†ç 

**åº”ç”¨é…ç½®**:
- `MB_JETTY_PORT`: Web ç«¯å£ (é»˜è®¤ 3000)
- `MB_SITE_URL`: ç«™ç‚¹ URL
- `MB_ENCRYPTION_SECRET_KEY`: åŠ å¯†å¯†é’¥

---

## ğŸ“Š ä»£ç è´¨é‡

### Lint å·¥å…·

```bash
# å‰ç«¯
yarn lint-eslint                  # ESLint
yarn lint-prettier                # Prettier
yarn type-check                   # TypeScript

# åç«¯
./bin/mage kondo                  # Clojure Kondo
./bin/mage cljfmt                 # æ ¼å¼åŒ–
```

### CI/CD

é¡¹ç›®ä½¿ç”¨ GitHub Actions è¿›è¡ŒæŒç»­é›†æˆ:
- ä»£ç  Lint
- å•å…ƒæµ‹è¯•
- E2E æµ‹è¯•
- æ„å»ºéªŒè¯
- è§†è§‰å›å½’æµ‹è¯•

---

ç»§ç»­é˜…è¯»:
- [ç¬¬ä¸€éƒ¨åˆ†: é¡¹ç›®æ¦‚è§ˆä¸æŠ€æœ¯æ ˆ](./01-é¡¹ç›®æ¦‚è§ˆä¸æŠ€æœ¯æ ˆ.md)
- [ç¬¬äºŒéƒ¨åˆ†: é¡¹ç›®æ¶æ„ä¸æ ¸å¿ƒæ¨¡å—](./02-é¡¹ç›®æ¶æ„ä¸æ ¸å¿ƒæ¨¡å—.md)
- [ç¬¬ä¸‰éƒ¨åˆ†: å¼€å‘å·¥ä½œæµä¸æœ€ä½³å®è·µ](./03-å¼€å‘å·¥ä½œæµä¸æœ€ä½³å®è·µ.md)
- [README: å®Œæ•´ç´¢å¼•](./README.md)
